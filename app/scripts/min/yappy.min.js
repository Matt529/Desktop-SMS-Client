function YappyClient(e){this.apiKey=e,this.unreadMap={},this.lastCheckTime=Date.now()}var fs=require("fs"),path=require("path"),util=require("util"),unirest=require("unirest"),jsonfile=require("jsonfile"),utility=require("./utility");YappyClient.prototype.makeGet=function(e,t,i){return unirest.get(e).field(t).set("Access-Token",this.apiKey).type("json").end(i)},YappyClient.prototype.makePost=function(e,t,i,a){return unirest.post(e).header(t).field(i).set("Access-Token",this.apiKey).type("json").end(a)},YappyClient.prototype.update=function(e,t){var i=this.devices,a=this,n=function(){return{results:500,include_names:!0,modified_after:a.lastCheckTime,active:!0}};for(var r in i){var s=i[r].identifier;this.makeGet("https://api.yappy.im/v1/devices/"+s+"/conversations",n,respFunc)}this.lastCheckTime=Date.now()},module.exports.createYappy=function(e,t){var i=new YappyClient(e);i.makeGet("https://api.yappy.im/v1/users/me",{},function(e){return i.user={name:e.body.name,email:e.body.email,avatar:e.body.avatar_url},i.makeGet("https://api.yappy.im/v1/devices",{},function(e){return i.devices=e.body.devices,t(i)})})};