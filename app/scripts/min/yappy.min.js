function YappyClient(e){this.apiKey=e,this.unreadMap={},this.lastCheckTime=Date.now()}var unirest=require("unirest");YappyClient.prototype.makeGet=function(e,t,i){return unirest.get(e).field(t).set("Access-Token",this.apiKey).type("json").end(i)},YappyClient.prototype.makePost=function(e,t,i,n){return unirest.post(e).header(t).field(i).set("Access-Token",this.apiKey).type("json").end(n)},YappyClient.prototype.update=function(e,t){var i=this.devices,n=this,s=function(){return{results:500,include_names:!0,modified_after:n.lastCheckTime,active:!0}};for(var p in i){var a=i[p].identifier;this.makeGet("https://api.yappy.im/v1/devices/"+a+"/conversations",s,respFunc)}this.lastCheckTime=Date.now()},module.exports.createYappy=function(e,t){var i=new YappyClient(e);i.makeGet("https://api.yappy.im/v1/users/me",{},function(e){return i.user=e.body,i.makeGet("https://api.yappy.im/v1/devices",{},function(e){return i.devices=e.body.devices,t(i)})})};